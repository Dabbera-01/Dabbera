<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dabba Run - Dabbera</title>
<style>
body { margin:0; font-family:'Arial Black',sans-serif; background: linear-gradient(135deg,#00c6ff,#ff416c); display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh; color:white; overflow:hidden;}
canvas { border:3px solid white; border-radius:15px; background:#222; }
button { margin-top:15px; padding:12px 25px; border:none; border-radius:10px; background:#1e90ff; color:white; font-size:18px; cursor:pointer; }
#startOverlay {
  position:absolute; top:50%; left:50%;
  transform:translate(-50%,-50%);
  background:rgba(0,0,0,0.7);
  padding:30px; border-radius:15px;
  text-align:center; cursor:pointer;
}
</style>
</head>
<body>

<h1>Dabba Run</h1>
<canvas id="dinoCanvas" width="600" height="200"></canvas>
<button onclick="location.href='index.html'">‚¨ÖÔ∏è Back to Hub</button>
<div id="startOverlay"><h2>üì¶ Dabba Run</h2><p>Click to Start</p></div>

<script>
const canvas=document.getElementById('dinoCanvas');
const ctx=canvas.getContext('2d');
const startOverlay=document.getElementById('startOverlay');

const dino={x:50,y:150,width:20,height:40,vy:0,jump:-10,gravity:0.5};
let obstacles=[], frame=0, score=0, gameStarted=false;

// Start overlay click
startOverlay.addEventListener('click', ()=>{
  gameStarted=true;
  startOverlay.style.display='none';
  initGame();
});

// Controls
document.addEventListener('keydown', e=>{ if(e.code==='Space') jump(); });
document.addEventListener('click', jump);

function jump(){
  if(dino.y===150) dino.vy=dino.jump;
}

function initGame(){
  obstacles=[];
  frame=0;
  score=0;
  dino.y=150;
  dino.vy=0;
  loop();
}

function drawDino(){
  ctx.fillStyle='lime';
  ctx.fillRect(dino.x,dino.y,dino.width,dino.height);
}

function drawObstacles(){
  ctx.fillStyle='red';
  obstacles.forEach(ob=>{
    ctx.fillRect(ob.x,ob.y,ob.width,ob.height);
  });
}

function loop(){
  if(!gameStarted) return;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Dino physics
  dino.vy+=dino.gravity;
  dino.y+=dino.vy;
  if(dino.y>150) dino.y=150;

  drawDino();

  // Obstacles
  if(frame%100===0){
    obstacles.push({x:canvas.width, y:150, width:20, height:40});
  }
  obstacles.forEach((ob,i)=>{
    ob.x-=5;
    // Collision
    if(dino.x<ob.x+ob.width && dino.x+dino.width>ob.x && dino.y<ob.y+ob.height && dino.y+dino.height>ob.y){
      resetGame();
    }
    // Score
    if(ob.x+ob.width===dino.x) score++;
  });

  drawObstacles();

  // Score
  ctx.fillStyle='white';
  ctx.font='20px Arial';
  ctx.fillText('Score: '+score,10,20);

  frame++;
  requestAnimationFrame(loop);
}

function resetGame(){
  // Update account score
  const currentUser=localStorage.getItem('currentUser');
  if(currentUser){
    let users=JSON.parse(localStorage.getItem('users'))||{};
    if(users[currentUser]){
      if(score>users[currentUser].scores.dino) users[currentUser].scores.dino=score;
      localStorage.setItem('users',JSON.stringify(users));
    }
  }

  gameStarted=false;
  frame=0;
  obstacles=[];
  score=0;
  dino.y=150;
  dino.vy=0;
  startOverlay.style.display='block';
}
</script>   

<script>
(function() {
  const faviconURL = 'favicon.gif'; // your animated GIF
  let link = document.querySelector("link[rel~='icon']");
  if (!link) {
    link = document.createElement('link');
    link.rel = 'icon';
    document.head.appendChild(link);
  }

  // For animated effect using a tiny trick (works in most browsers)
  let i = 0;
  const frames = 30; // total frames your GIF has, approx
  setInterval(() => {
    link.href = faviconURL + '?frame=' + i;
    i = (i + 1) % frames;
  }, 100); // change frame every 100ms
})();
</script>

<div id="musicPlayer" style="position:fixed;bottom:10px;right:10px;z-index:9999;">
  <button onclick="togglePlayer()">üéµ</button>
  <iframe id="spotifyIframe" 
      style="border-radius:12px;margin-top:5px;" 
      src="https://open.spotify.com/embed/playlist/0PMKjSoU937cvzkHpFJ3hf?utm_source=generator&theme=0" 
      width="300" height="80" frameborder="0" allow="encrypted-media">
  </iframe>
</div>

<script>
function togglePlayer(){
  const iframe = document.getElementById('spotifyIframe');
  iframe.style.display = (iframe.style.display==='none') ? 'block':'none';
}
</script>



</body>
</html>
