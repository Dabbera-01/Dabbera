<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dabba Flappy - Dabbera</title>
<style>
body {
  margin:0;
  background: linear-gradient(135deg, #1e90ff, #ff4757);
  display:flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height:100vh;
  overflow:hidden;
  font-family: 'Arial Black', sans-serif;
  color:white;
  position: relative;
}
#gameArea {
  position: relative;
  width: 400px;
  height: 500px;
  border:3px solid white;
  border-radius:15px;
  background: skyblue;
  overflow: hidden;
}
#scoreDisplay {
  position:absolute;
  top:10px; left:10px;
  font-size:24px;
  font-weight:bold;
  text-shadow: 2px 2px 5px black;
}
#startScreen {
  position:absolute;
  top:50%; left:50%;
  transform: translate(-50%, -50%);
  width: 300px;
  background:rgba(128,128,128,0.8);
  padding:30px;
  border-radius:15px;
  text-align:center;
  cursor:pointer;
}
button {
  margin-top:15px;
  padding:12px 25px;
  border:none;
  border-radius:10px;
  background:#00c6ff;
  color:white;
  font-size:18px;
  cursor:pointer;
}
</style>
</head>
<body>

<h1>Dabba Flappy</h1>
<div id="gameArea">
  <div id="scoreDisplay">Score: 0</div>
  <div id="startScreen">
    <h2>üì¶ Dabba Flappy</h2>
    <p>Click or Tap to Start</p>
  </div>
</div>
<button onclick="location.href='index.html'">‚¨ÖÔ∏è Back to Hub</button>

<script>
const gameArea = document.getElementById('gameArea');
const startScreen = document.getElementById('startScreen');
const scoreDisplay = document.getElementById('scoreDisplay');

let gameStarted = false;
let bird = {x:80, y:220, width:30, height:30, velocity:0, gravity:0.6, jump:-10};
let pipes = [];
let frame = 0;
let score = 0;

// Start screen click
startScreen.addEventListener('click', ()=>{
  gameStarted = true;
  startScreen.style.display='none';
});

// Controls
document.addEventListener('keydown', e=>{ if(e.code==='Space') bird.velocity = bird.jump; });
document.addEventListener('click', ()=>{ if(gameStarted) bird.velocity = bird.jump; });

// Game loop
function loop(){
  const ctx = getContext();
  if(gameStarted){
    bird.velocity += bird.gravity;
    bird.y += bird.velocity;

    ctx.clearRect(0,0,400,500);
    // Draw bird
    ctx.fillStyle='yellow';
    ctx.fillRect(bird.x,bird.y,bird.width,bird.height);

    // Generate pipes
    if(frame % 100 === 0){
      const topHeight = Math.random()*200+50;
      const gap = 120;
      pipes.push({x:400, top:topHeight, bottom:topHeight+gap, width:40});
    }

    // Draw pipes
    for(let i=pipes.length-1;i>=0;i--){
      let p = pipes[i];
      p.x -= 2;
      ctx.fillStyle='green';
      ctx.fillRect(p.x,0,p.width,p.top);
      ctx.fillRect(p.x,p.bottom,p.width,500-p.bottom);

      // Collision
      if(bird.x + bird.width > p.x && bird.x < p.x + p.width &&
         (bird.y < p.top || bird.y + bird.height > p.bottom)) resetGame();

      // Score
      if(p.x + p.width === bird.x) score++;

      if(p.x + p.width < 0) pipes.splice(i,1);
    }

    // Ground/ceiling
    if(bird.y < 0 || bird.y + bird.height > 500) resetGame();

    scoreDisplay.textContent = 'Score: ' + score;
    frame++;
  }
  requestAnimationFrame(loop);
}

function resetGame(){
  bird.y = 220; bird.velocity = 0; pipes = []; frame=0; score=0;
  gameStarted=false;
  startScreen.style.display='block';
}

function getContext(){
  if(!gameArea.canvas){
    const canvas = document.createElement('canvas');
    canvas.width=400; canvas.height=500;
    gameArea.appendChild(canvas);
    gameArea.canvas = canvas;
  }
  return gameArea.canvas.getContext('2d');
}

loop();
</script>

<script>
(function() {
  const faviconURL = 'favicon.gif'; // your animated GIF
  let link = document.querySelector("link[rel~='icon']");
  if (!link) {
    link = document.createElement('link');
    link.rel = 'icon';
    document.head.appendChild(link);
  }

  // For animated effect using a tiny trick (works in most browsers)
  let i = 0;
  const frames = 30; // total frames your GIF has, approx
  setInterval(() => {
    link.href = faviconURL + '?frame=' + i;
    i = (i + 1) % frames;
  }, 100); // change frame every 100ms
})();
</script>

<div id="musicPlayer" style="position:fixed;bottom:10px;right:10px;z-index:9999;">
  <button onclick="togglePlayer()">üéµ</button>
  <iframe id="spotifyIframe" 
      style="border-radius:12px;margin-top:5px;" 
      src="https://open.spotify.com/embed/playlist/0PMKjSoU937cvzkHpFJ3hf?utm_source=generator&theme=0" 
      width="300" height="80" frameborder="0" allow="encrypted-media">
  </iframe>
</div>

<script>
function togglePlayer(){
  const iframe = document.getElementById('spotifyIframe');
  iframe.style.display = (iframe.style.display==='none') ? 'block':'none';
}
</script>



</body>
</html>
